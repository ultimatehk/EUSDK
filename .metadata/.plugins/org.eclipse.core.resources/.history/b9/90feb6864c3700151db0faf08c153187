package cn.eugames.extension.utils;

import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.Collections;

import android.content.Context;

/**
 * 版本工具
 * 
 * @author gzx
 *
 */
public class VersionUtil {
    //这里记录统一SDK版本号
	protected static final String euSDKVersion = "1.0.0";
	private ArrayList<String> deBugMacList = new ArrayList<>();
	private static boolean isDeBug = false;
	private static VersionUtil versionUtil = null;
	private static Context mContext;

	private VersionUtil() {
		isDeBug = isDeBugPhone();
	}

	public static VersionUtil getInstance(Context context) {
		mContext = context;
		if (versionUtil == null)
			versionUtil = new VersionUtil();
		return versionUtil;
	}

	/**
	 * 是否debug模式
	 * 
	 * @return
	 */
	public static boolean deBug() {
		return isDeBug;
	}
	
	public static String getVersion(){
		return euSDKVersion;
	}

	/**
	 * 弹出版本号信息
	 */
	public void showVersion() {
		if (isDeBug)
			Utils.showToast(mContext, "艺游SDK版本号：" + euSDKVersion);
	}

	/**
	 * 弹出测试信息
	 * 
	 * @param msg
	 */
	public void showDeBugMsg(String msg) {
		if (isDeBug)
			Utils.showToast(mContext, msg);
	}

	/**
	 * 判断是否为debug设备
	 * 
	 * @return
	 */
	private boolean isDeBugPhone() {
		boolean isDebug = false;
		try {
			addMacMessage();
			isDebug = deBugMacList.contains(Utils.getMacAddr(mContext)
					.toUpperCase());
		} catch (Exception e) {
			e.printStackTrace();
			isDebug = false;
		}

		return isDebug;
	}

	/**
	 * 添加测试设备mac信息
	 * 
	 * @throws IOException
	 */
	private void addMacMessage() {
		deBugMacList.add("88:32:9B:2A:0D:7D");
		//三星pad
		deBugMacList.add("64:6C:B2:0D:B5:E3");
		deBugMacList.add("18:DC:56:B7:29:56");
		deBugMacList.add("D4:20:6D:09:57:D0");
		deBugMacList.add("B8:B3:77:F2:D9:59");
		deBugMacList.add("E8:99:C4:B3:68:3A");
		deBugMacList.add("CC:3A:61:79:30:8C");
		deBugMacList.add("20:02:AF:79:53:54");
		deBugMacList.add("AC:F7:F3:12:64:0B");
		deBugMacList.add("64:B4:73:4E:C4:AC");
		deBugMacList.add("A8:16:B2:94:AB:77");
		deBugMacList.add("4C:8B:Ef:37:CA:7E");
		deBugMacList.add("38:BC:1A:84:E2:4C");
		deBugMacList.add("9C:A9:E4:5C:FB:44");
		deBugMacList.add("18:DC:56:B7:29:56");
		deBugMacList.add("80:CF:41:67:33:0A");
		deBugMacList.add("80:41:4E:A2:35:B1");
		deBugMacList.add("38:AA:3C:7E:00:0B");

		try {
			int id = mContext.getResources().getIdentifier("gydebug", "raw",
					mContext.getPackageName());
			InputStream inStream = mContext.getResources().openRawResource(id);
			byte[] msgBytes = ConfigUtils.readInputStreamToByte(inStream);
			String[] macs = new String(msgBytes, "UTF-8").split("\n");
			Collections.addAll(deBugMacList, macs);
		} catch (Exception e) {

		}

	}
}
